-- back compat for old kwarg name
  
  begin;
    
        
            
            
        
    

    

    merge into whoop.raw.stg_sleep as DBT_INTERNAL_DEST
        using whoop.raw.stg_sleep__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.ID = DBT_INTERNAL_DEST.ID
            )

    
    when matched then update set
        "ID" = DBT_INTERNAL_SOURCE."ID","V1_ID" = DBT_INTERNAL_SOURCE."V1_ID","USER_ID" = DBT_INTERNAL_SOURCE."USER_ID","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","START_TIME" = DBT_INTERNAL_SOURCE."START_TIME","END_TIME" = DBT_INTERNAL_SOURCE."END_TIME","TIMEZONE_OFFSET" = DBT_INTERNAL_SOURCE."TIMEZONE_OFFSET","NAP" = DBT_INTERNAL_SOURCE."NAP","SCORE_STATE" = DBT_INTERNAL_SOURCE."SCORE_STATE","TOTAL_IN_BED_TIME_MILLI" = DBT_INTERNAL_SOURCE."TOTAL_IN_BED_TIME_MILLI","TOTAL_AWAKE_TIME_MILLI" = DBT_INTERNAL_SOURCE."TOTAL_AWAKE_TIME_MILLI","TOTAL_NO_DATA_TIME_MILLI" = DBT_INTERNAL_SOURCE."TOTAL_NO_DATA_TIME_MILLI","TOTAL_LIGHT_SLEEP_TIME_MILLI" = DBT_INTERNAL_SOURCE."TOTAL_LIGHT_SLEEP_TIME_MILLI","TOTAL_SLOW_WAVE_SLEEP_TIME_MILLI" = DBT_INTERNAL_SOURCE."TOTAL_SLOW_WAVE_SLEEP_TIME_MILLI","TOTAL_REM_SLEEP_TIME_MILLI" = DBT_INTERNAL_SOURCE."TOTAL_REM_SLEEP_TIME_MILLI","SLEEP_CYCLE_COUNT" = DBT_INTERNAL_SOURCE."SLEEP_CYCLE_COUNT","DISTURBANCE_COUNT" = DBT_INTERNAL_SOURCE."DISTURBANCE_COUNT","BASELINE_MILLI" = DBT_INTERNAL_SOURCE."BASELINE_MILLI","NEED_FROM_SLEEP_DEBT_MILLI" = DBT_INTERNAL_SOURCE."NEED_FROM_SLEEP_DEBT_MILLI","NEED_FROM_RECENT_STRAIN_MILLI" = DBT_INTERNAL_SOURCE."NEED_FROM_RECENT_STRAIN_MILLI","NEED_FROM_RECENT_NAP_MILLI" = DBT_INTERNAL_SOURCE."NEED_FROM_RECENT_NAP_MILLI","RESPIRATORY_RATE" = DBT_INTERNAL_SOURCE."RESPIRATORY_RATE","SLEEP_PERFORMANCE_PERCENTAGE" = DBT_INTERNAL_SOURCE."SLEEP_PERFORMANCE_PERCENTAGE","SLEEP_CONSISTENCY_PERCENTAGE" = DBT_INTERNAL_SOURCE."SLEEP_CONSISTENCY_PERCENTAGE","SLEEP_EFFICIENCY_PERCENTAGE" = DBT_INTERNAL_SOURCE."SLEEP_EFFICIENCY_PERCENTAGE","INGESTED_AT" = DBT_INTERNAL_SOURCE."INGESTED_AT"
    

    when not matched then insert
        ("ID", "V1_ID", "USER_ID", "CREATED_AT", "UPDATED_AT", "START_TIME", "END_TIME", "TIMEZONE_OFFSET", "NAP", "SCORE_STATE", "TOTAL_IN_BED_TIME_MILLI", "TOTAL_AWAKE_TIME_MILLI", "TOTAL_NO_DATA_TIME_MILLI", "TOTAL_LIGHT_SLEEP_TIME_MILLI", "TOTAL_SLOW_WAVE_SLEEP_TIME_MILLI", "TOTAL_REM_SLEEP_TIME_MILLI", "SLEEP_CYCLE_COUNT", "DISTURBANCE_COUNT", "BASELINE_MILLI", "NEED_FROM_SLEEP_DEBT_MILLI", "NEED_FROM_RECENT_STRAIN_MILLI", "NEED_FROM_RECENT_NAP_MILLI", "RESPIRATORY_RATE", "SLEEP_PERFORMANCE_PERCENTAGE", "SLEEP_CONSISTENCY_PERCENTAGE", "SLEEP_EFFICIENCY_PERCENTAGE", "INGESTED_AT")
    values
        ("ID", "V1_ID", "USER_ID", "CREATED_AT", "UPDATED_AT", "START_TIME", "END_TIME", "TIMEZONE_OFFSET", "NAP", "SCORE_STATE", "TOTAL_IN_BED_TIME_MILLI", "TOTAL_AWAKE_TIME_MILLI", "TOTAL_NO_DATA_TIME_MILLI", "TOTAL_LIGHT_SLEEP_TIME_MILLI", "TOTAL_SLOW_WAVE_SLEEP_TIME_MILLI", "TOTAL_REM_SLEEP_TIME_MILLI", "SLEEP_CYCLE_COUNT", "DISTURBANCE_COUNT", "BASELINE_MILLI", "NEED_FROM_SLEEP_DEBT_MILLI", "NEED_FROM_RECENT_STRAIN_MILLI", "NEED_FROM_RECENT_NAP_MILLI", "RESPIRATORY_RATE", "SLEEP_PERFORMANCE_PERCENTAGE", "SLEEP_CONSISTENCY_PERCENTAGE", "SLEEP_EFFICIENCY_PERCENTAGE", "INGESTED_AT")

;
    commit;