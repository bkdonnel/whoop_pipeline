-- back compat for old kwarg name
  
  begin;
    
        
            
            
        
    

    

    merge into whoop.raw.stg_recovery as DBT_INTERNAL_DEST
        using whoop.raw.stg_recovery__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                DBT_INTERNAL_SOURCE.CYCLE_ID = DBT_INTERNAL_DEST.CYCLE_ID
            )

    
    when matched then update set
        "CYCLE_ID" = DBT_INTERNAL_SOURCE."CYCLE_ID","SLEEP_ID" = DBT_INTERNAL_SOURCE."SLEEP_ID","USER_ID" = DBT_INTERNAL_SOURCE."USER_ID","CREATED_AT" = DBT_INTERNAL_SOURCE."CREATED_AT","UPDATED_AT" = DBT_INTERNAL_SOURCE."UPDATED_AT","SCORE_STATE" = DBT_INTERNAL_SOURCE."SCORE_STATE","USER_CALIBRATING" = DBT_INTERNAL_SOURCE."USER_CALIBRATING","RECOVERY_SCORE" = DBT_INTERNAL_SOURCE."RECOVERY_SCORE","RESTING_HEART_RATE" = DBT_INTERNAL_SOURCE."RESTING_HEART_RATE","HRV_RMSSD_MILLI" = DBT_INTERNAL_SOURCE."HRV_RMSSD_MILLI","SPO2_PERCENTAGE" = DBT_INTERNAL_SOURCE."SPO2_PERCENTAGE","SKIN_TEMP_CELSIUS" = DBT_INTERNAL_SOURCE."SKIN_TEMP_CELSIUS","INGESTED_AT" = DBT_INTERNAL_SOURCE."INGESTED_AT"
    

    when not matched then insert
        ("CYCLE_ID", "SLEEP_ID", "USER_ID", "CREATED_AT", "UPDATED_AT", "SCORE_STATE", "USER_CALIBRATING", "RECOVERY_SCORE", "RESTING_HEART_RATE", "HRV_RMSSD_MILLI", "SPO2_PERCENTAGE", "SKIN_TEMP_CELSIUS", "INGESTED_AT")
    values
        ("CYCLE_ID", "SLEEP_ID", "USER_ID", "CREATED_AT", "UPDATED_AT", "SCORE_STATE", "USER_CALIBRATING", "RECOVERY_SCORE", "RESTING_HEART_RATE", "HRV_RMSSD_MILLI", "SPO2_PERCENTAGE", "SKIN_TEMP_CELSIUS", "INGESTED_AT")

;
    commit;