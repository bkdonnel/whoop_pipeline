{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.18", "generated_at": "2025-09-11T22:57:35.823592Z", "invocation_id": "35699c04-d346-473f-9fde-e85f3b2f656a", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-11T22:57:30.753751Z", "completed_at": "2025-09-11T22:57:30.761433Z"}, {"name": "execute", "started_at": "2025-09-11T22:57:30.789227Z", "completed_at": "2025-09-11T22:57:32.166713Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.6552302837371826, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01befd21-0003-79a9-0009-1cc2000ae3d2"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.whoop_dbt.stg_user", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n\n    SELECT\n    \n            USER_ID::string AS USER_ID\n        ,\n    \n            EMAIL::string AS EMAIL\n        ,\n    \n            FIRST_NAME::string AS FIRST_NAME\n        ,\n    \n            LAST_NAME::string AS LAST_NAME\n        ,\n    \n            CREATED_AT::timestamp_ntz AS CREATED_AT\n        ,\n    \n            UPDATED_AT::timestamp_ntz AS UPDATED_AT\n        ,\n    \n            INGESTED_AT::timestamp_ntz AS INGESTED_AT\n        \n    \n    FROM whoop.raw.user\n", "relation_name": "whoop.raw.stg_user"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-11T22:57:30.741943Z", "completed_at": "2025-09-11T22:57:30.761184Z"}, {"name": "execute", "started_at": "2025-09-11T22:57:30.787234Z", "completed_at": "2025-09-11T22:57:33.805795Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 3.2918505668640137, "adapter_response": {"_message": "SUCCESS 11", "code": "SUCCESS", "rows_affected": 11, "query_id": "01befd21-0003-7d27-0009-1cc2000c142e"}, "message": "SUCCESS 11", "failures": null, "unique_id": "model.whoop_dbt.stg_recovery", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\nWITH base AS (\n    \n    SELECT\n    \n            CYCLE_ID::string AS CYCLE_ID\n        ,\n    \n            SLEEP_ID::string AS SLEEP_ID\n        ,\n    \n            USER_ID::string AS USER_ID\n        ,\n    \n            CREATED_AT::timestamp_ntz AS CREATED_AT\n        ,\n    \n            UPDATED_AT::timestamp_ntz AS UPDATED_AT\n        ,\n    \n            SCORE_STATE::string AS SCORE_STATE\n        ,\n    \n            USER_CALIBRATING::boolean AS USER_CALIBRATING\n        ,\n    \n            RECOVERY_SCORE::int AS RECOVERY_SCORE\n        ,\n    \n            RESTING_HEART_RATE::int AS RESTING_HEART_RATE\n        ,\n    \n            HRV_RMSSD_MILLI::int AS HRV_RMSSD_MILLI\n        ,\n    \n            SPO2_PERCENTAGE::int AS SPO2_PERCENTAGE\n        ,\n    \n            SKIN_TEMP_CELSIUS::int AS SKIN_TEMP_CELSIUS\n        ,\n    \n            INGESTED_AT::timestamp_ntz AS INGESTED_AT\n        \n    \n    FROM whoop.raw.recovery\n\n    \n    \n    WHERE ingested_at > (SELECT COALESCE(MAX(ingested_at), '1900-01-01') FROM whoop.raw.stg_recovery)\n    \n)\n\nSELECT * FROM base", "relation_name": "whoop.raw.stg_recovery"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-11T22:57:30.730047Z", "completed_at": "2025-09-11T22:57:30.760507Z"}, {"name": "execute", "started_at": "2025-09-11T22:57:30.763177Z", "completed_at": "2025-09-11T22:57:33.941367Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 3.4154202938079834, "adapter_response": {"_message": "SUCCESS 8", "code": "SUCCESS", "rows_affected": 8, "query_id": "01befd21-0003-7c30-0009-1cc2000bf40e"}, "message": "SUCCESS 8", "failures": null, "unique_id": "model.whoop_dbt.stg_cycle", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\nWITH ranked_data AS (\n    \n    SELECT\n    \n            ID::string AS ID\n        ,\n    \n            USER_ID::string AS USER_ID\n        ,\n    \n            CREATED_AT::timestamp_ntz AS CREATED_AT\n        ,\n    \n            UPDATED_AT::timestamp_ntz AS UPDATED_AT\n        ,\n    \n            START_TIME::timestamp_ntz AS START_TIME\n        ,\n    \n            END_TIME::timestamp_ntz AS END_TIME\n        ,\n    \n            TIMEZONE_OFFSET::string AS TIMEZONE_OFFSET\n        ,\n    \n            SCORE_STATE::string AS SCORE_STATE\n        ,\n    \n            STRAIN::int AS STRAIN\n        ,\n    \n            KILOJOULE::int AS KILOJOULE\n        ,\n    \n            AVERAGE_HEART_RATE::int AS AVERAGE_HEART_RATE\n        ,\n    \n            MAX_HEART_RATE::int AS MAX_HEART_RATE\n        ,\n    \n            INGESTED_AT::timestamp_ntz AS INGESTED_AT\n        \n    \n    FROM whoop.raw.cycle\n\n    \n    \n    WHERE ingested_at > (SELECT COALESCE(MAX(ingested_at), '1900-01-01') FROM whoop.raw.stg_cycle)\n    \n),\n\ndeduped AS (\n    SELECT *,\n           ROW_NUMBER() OVER (PARTITION BY ID ORDER BY ingested_at DESC, UPDATED_AT DESC) as rn\n    FROM ranked_data\n)\n\nSELECT * EXCLUDE (rn) FROM deduped WHERE rn = 1", "relation_name": "whoop.raw.stg_cycle"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-11T22:57:30.747011Z", "completed_at": "2025-09-11T22:57:30.760861Z"}, {"name": "execute", "started_at": "2025-09-11T22:57:30.784482Z", "completed_at": "2025-09-11T22:57:34.006137Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 3.495328664779663, "adapter_response": {"_message": "SUCCESS 7", "code": "SUCCESS", "rows_affected": 7, "query_id": "01befd21-0003-7d27-0009-1cc2000c142a"}, "message": "SUCCESS 7", "failures": null, "unique_id": "model.whoop_dbt.stg_sleep", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\nWITH ranked_data AS (\n    \n    SELECT\n    \n            ID::string AS ID\n        ,\n    \n            V1_ID::string AS V1_ID\n        ,\n    \n            USER_ID::string AS USER_ID\n        ,\n    \n            CREATED_AT::timestamp_ntz AS CREATED_AT\n        ,\n    \n            UPDATED_AT::timestamp_ntz AS UPDATED_AT\n        ,\n    \n            START_TIME::timestamp_ntz AS START_TIME\n        ,\n    \n            END_TIME::timestamp_ntz AS END_TIME\n        ,\n    \n            TIMEZONE_OFFSET::string AS TIMEZONE_OFFSET\n        ,\n    \n            NAP::boolean AS NAP\n        ,\n    \n            SCORE_STATE::string AS SCORE_STATE\n        ,\n    \n            TOTAL_IN_BED_TIME_MILLI / 3600000 AS TOTAL_IN_BED_TIME_MILLI\n        ,\n    \n            TOTAL_AWAKE_TIME_MILLI / 60000 AS TOTAL_AWAKE_TIME_MILLI\n        ,\n    \n            TOTAL_NO_DATA_TIME_MILLI / 60000 AS TOTAL_NO_DATA_TIME_MILLI\n        ,\n    \n            TOTAL_LIGHT_SLEEP_TIME_MILLI / 3600000 AS TOTAL_LIGHT_SLEEP_TIME_MILLI\n        ,\n    \n            TOTAL_SLOW_WAVE_SLEEP_TIME_MILLI / 3600000 AS TOTAL_SLOW_WAVE_SLEEP_TIME_MILLI\n        ,\n    \n            TOTAL_REM_SLEEP_TIME_MILLI / 3600000 AS TOTAL_REM_SLEEP_TIME_MILLI\n        ,\n    \n            SLEEP_CYCLE_COUNT::int AS SLEEP_CYCLE_COUNT\n        ,\n    \n            DISTURBANCE_COUNT::int AS DISTURBANCE_COUNT\n        ,\n    \n            BASELINE_MILLI / 3600000 AS BASELINE_MILLI\n        ,\n    \n            NEED_FROM_SLEEP_DEBT_MILLI / 3600000 AS NEED_FROM_SLEEP_DEBT_MILLI\n        ,\n    \n            NEED_FROM_RECENT_STRAIN_MILLI / 3600000 AS NEED_FROM_RECENT_STRAIN_MILLI\n        ,\n    \n            NEED_FROM_RECENT_NAP_MILLI / 3600000 AS NEED_FROM_RECENT_NAP_MILLI\n        ,\n    \n            RESPIRATORY_RATE::int AS RESPIRATORY_RATE\n        ,\n    \n            SLEEP_PERFORMANCE_PERCENTAGE::int AS SLEEP_PERFORMANCE_PERCENTAGE\n        ,\n    \n            SLEEP_CONSISTENCY_PERCENTAGE::int AS SLEEP_CONSISTENCY_PERCENTAGE\n        ,\n    \n            SLEEP_EFFICIENCY_PERCENTAGE::int AS SLEEP_EFFICIENCY_PERCENTAGE\n        ,\n    \n            INGESTED_AT::timestamp_ntz AS INGESTED_AT\n        \n    \n    FROM whoop.raw.sleep\n\n    \n    \n    WHERE ingested_at > (SELECT COALESCE(MAX(ingested_at), '1900-01-01') FROM whoop.raw.stg_sleep)\n    \n),\n\ndeduped AS (\n    SELECT *,\n           ROW_NUMBER() OVER (PARTITION BY ID ORDER BY ingested_at DESC, UPDATED_AT DESC) as rn\n    FROM ranked_data\n)\n\nSELECT * EXCLUDE (rn) FROM deduped WHERE rn = 1", "relation_name": "whoop.raw.stg_sleep"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-11T22:57:32.385783Z", "completed_at": "2025-09-11T22:57:32.392087Z"}, {"name": "execute", "started_at": "2025-09-11T22:57:32.392972Z", "completed_at": "2025-09-11T22:57:35.587810Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 3.4216268062591553, "adapter_response": {"_message": "SUCCESS 9", "code": "SUCCESS", "rows_affected": 9, "query_id": "01befd21-0003-7d27-0009-1cc2000c1436"}, "message": "SUCCESS 9", "failures": null, "unique_id": "model.whoop_dbt.stg_workout", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\nWITH ranked_data AS (\n    \n    SELECT\n    \n            ID::string AS ID\n        ,\n    \n            V1_ID::string AS V1_ID\n        ,\n    \n            USER_ID::string AS USER_ID\n        ,\n    \n            CREATED_AT::timestamp_ntz AS CREATED_AT\n        ,\n    \n            UPDATED_AT::timestamp_ntz AS UPDATED_AT\n        ,\n    \n            START_TIME::timestamp_ntz AS START_TIME\n        ,\n    \n            END_TIME::timestamp_ntz AS END_TIME\n        ,\n    \n            TIMEZONE_OFFSET::string AS TIMEZONE_OFFSET\n        ,\n    \n            SPORT_NAME::string AS SPORT_NAME\n        ,\n    \n            SPORT_ID::string AS SPORT_ID\n        ,\n    \n            SCORE_STATE::string AS SCORE_STATE\n        ,\n    \n            STRAIN::int AS STRAIN\n        ,\n    \n            AVERAGE_HEART_RATE::int AS AVERAGE_HEART_RATE\n        ,\n    \n            MAX_HEART_RATE::int AS MAX_HEART_RATE\n        ,\n    \n            KILOJOULE::int AS KILOJOULE\n        ,\n    \n            PERCENT_RECORDED::int AS PERCENT_RECORDED\n        ,\n    \n            DISTANCE_METER::int AS DISTANCE_METER\n        ,\n    \n            ALTITUDE_GAIN_METER::int AS ALTITUDE_GAIN_METER\n        ,\n    \n            ALTITUDE_CHANGE_METER::int AS ALTITUDE_CHANGE_METER\n        ,\n    \n            ZONE_ZERO_MILLI / 60000 AS ZONE_ZERO_MILLI\n        ,\n    \n            ZONE_ONE_MILLI / 60000 AS ZONE_ONE_MILLI\n        ,\n    \n            ZONE_TWO_MILLI / 60000 AS ZONE_TWO_MILLI\n        ,\n    \n            ZONE_THREE_MILLI / 60000 AS ZONE_THREE_MILLI\n        ,\n    \n            ZONE_FOUR_MILLI / 60000 AS ZONE_FOUR_MILLI\n        ,\n    \n            ZONE_FIVE_MILLI / 60000 AS ZONE_FIVE_MILLI\n        ,\n    \n            INGESTED_AT::timestamp_ntz AS INGESTED_AT\n        \n    \n    FROM whoop.raw.workout\n\n    \n    \n    WHERE ingested_at > (SELECT COALESCE(MAX(ingested_at), '1900-01-01') FROM whoop.raw.stg_workout)\n    \n),\n\ndeduped AS (\n    SELECT *,\n           ROW_NUMBER() OVER (PARTITION BY ID ORDER BY ingested_at DESC, UPDATED_AT DESC) as rn\n    FROM ranked_data\n)\n\nSELECT * EXCLUDE (rn) FROM deduped WHERE rn = 1", "relation_name": "whoop.raw.stg_workout"}], "elapsed_time": 7.363238096237183, "args": {"populate_cache": true, "write_json": true, "introspect": true, "favor_state": false, "strict_mode": false, "warn_error_options": {"include": [], "exclude": []}, "select": ["tag:staging"], "profiles_dir": "/app/dbt", "cache_selected_only": false, "log_file_max_bytes": 10485760, "print": true, "indirect_selection": "eager", "static_parser": true, "require_explicit_package_overrides_for_builtin_materializations": false, "log_level_file": "debug", "vars": {}, "log_format": "default", "use_colors_file": true, "printer_width": 80, "log_format_file": "debug", "partial_parse": true, "exclude": [], "quiet": false, "use_colors": true, "send_anonymous_usage_stats": true, "defer": false, "log_path": "/app/dbt/logs", "partial_parse_file_diff": true, "version_check": true, "which": "run", "show_resource_report": false, "enable_legacy_logger": false, "macro_debugging": false, "invocation_command": "dbt run --select tag:staging", "log_level": "info", "project_dir": "/app/dbt"}}